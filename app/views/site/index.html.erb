<div class="container">
  <div class="row">

      <div class="span12">
        <form class="navbar-form navbar-left" action="<%= index_path %>">
          <div class="form-group">
            <input type="text" class="form-control" name="key_word" value="<%= @search[:key_word] %>" placeholder="Search">
          </div>
          <button type="submit" class="btn btn-default">Submit</button>
        </form>
      </div>

  </div>
  <div class="two-space"></div>
  <% @users.each do |user| %>
  <div class="row">
    <div class="col-md-12">
      <div class="well well-sm">
        <div class="media">
          <a class="thumbnail pull-left" href="<%= user_path(user.id)%>">
            <%= image_tag user.image.url(:thumb), class: 'media-object' %>
          </a>
          <div class="media-body">
            <h4 class="media-heading"><%= user.name %> <span class="title-email">@<%= user.email %></span></h4>
            <p><span class="label label-info">150 Friends</span></p>

            <p>
              <% if current_user && user.id == current_user.id %>
                  <span class="label label-warning">Is Me</span>
              <% else %>

                  <!--friend-->
                  <% if current_user && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first != nil && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first.is_friend == 1 %>
                      <a href="#" <% if !current_user %> data-toggle="modal" data-target="#myModal" <% else %> onclick="un_friend(<%= user.id %>,'<%= post_un_friend_path %>')"<% end %> class="btn btn-xs btn-default"> <span id="icon-friend-<%=user.id %>" class="glyphicon glyphicon-remove"></span> Unfriend</a>
                  <% else %>
                      <!--request-->
                      <% if current_user && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first != nil && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first.is_request_friend == 1 %>
                          <a href="#" <% if !current_user %> data-toggle="modal" data-target="#myModal" <% else %> onclick="un_request(<%= user.id %>,'<%= post_un_request_path %>')"<% end %> class="btn btn-xs btn-default"><span class="glyphicon glyphicon-minus"></span> Un Request</a>
                      <% else %>
                          <a href="#" <% if !current_user %> data-toggle="modal" data-target="#myModal" <% else %> onclick="add_friend(<%= user.id %>,'<%= post_add_friend_path %>')"<% end %> class="btn btn-xs btn-default"> <span id="icon-friend-<%=user.id %>" class="glyphicon glyphicon-plus"></span>Add Friend</a>
                      <%end%>
                  <%end%>



                <% if current_user && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first != nil && current_user.friends.where(["friend_user_id = ?","#{user.id}"]).first.is_favorite == 1 %>
                      <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-ban-circle"></span> Unfavorite</a>
                <% else %>
                      <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-heart"></span> Favorite</a>
                <%end%>

              <% end %>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% end %>
  <div class="text-center">
    <div class="pagination">
      <%= will_paginate @users, renderer: BootstrapPagination::Rails %>
    </div>
  </div>
</div>
</div>
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Login</h4>
      </div>
      <div class="modal-body">
        <%= form_tag '/login' do %>

            Email: <%= text_field_tag :email %>
            Password: <%= password_field_tag :password %>
            <%= submit_tag "Submit" %>

        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
